---
layout: howtos
title: Background Jobs
secondtitle: jobs
permalink: /background-jobs
---
<div style="padding:10px;min-height:500px;">  
  <div class="text-title">
    Jobs
  </div>
  <div class="text-text">
      Tales provides the "Job" class to help create background jobs. A "Job" is nothing but a special kind of Actor managed by tales. The "Job" has two methods that you can override "setup" and "doJob"
  </div>
  <div class="text-title">
     Run code on server startup
  </div>
  <div class="text-text">
      You can override the setup method to run code on server startup
      <pre>using tales

const class Startup : Job{
    new make() : super("startup"){}

    override Void setup(){
        echo("On Startup")
    }
}</pre>
    "On Startup" will be printed on sever startup. There is no need for any more configuration. On startup, tales will scan all classes that extends Job and call the "setup" method
  </div>
  <div class="text-text">
      Note that code in "setup" method will block the server from starting up - that is utill all Job's setup method is not complete, the server cannot take it's first request. If you want the execute something on startup but in the background, you can send the job a message from the "setup" method and handle it on the "doJob" method. 
      <pre>using tales
        
const class Startup : Job{
    new make() : super("Test job"){}

    override Void setup(){
        this.send(null)
    }

    override Obj? doJob(Obj? msg){
        echo("On Startup")
        return null
    }
}</pre>
  </div>
   <div class="text-text">
      The above code is equivalent to the first one except that the execution will happen on the background and will not block the server from starting up
   </div>
   <div class="text-title">
      Running Recurring background jobs
   </div>
   <div class="text-text">
       You can for example configure a job to run every 1hr using standard methods in Actor class. Here's an example
       <pre>using tales

const class MailChecker : Job{
   new make() : super("Mailer"){}

   override Void setup(){
       this.sendLater(1hr, null)
   }

   override Obj? doJob(Obj? msg){
       checkForNewAccountsAndSendMail
       this.sendLater(1hr, null)
       return null
   }
}</pre>
         
    </div>
</div>